# M = 2 cases
M2 = [1, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 21, 22, 24, 25, 27, 28,
      30, 32, 34, 35, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46,
      47, 48, 49, 50, 65, 66, 68, 70, 74, 75, 77, 79, 80, 81,
      82, 83, 84, 86, 88, 89, 93, 98, 99, 100, 101, 102, 105,
      107, 108, 109, 111, 112, 115, 119, 122, 123, 131, 141,
      143, 146, 147, 148, 149, 150, 155, 156, 157, 160, 162,
      164, 166, 168, 174, 175, 177, 183, 187, 189, 191, 195,
      196, 199, 200, 203, 207, 210, 214, 215, 216, 221, 227]

# M ≥ 3 cases
M3 = unique(
        [23, 71,72,97,121,139,140,197,204,209,211,217,225,226,229,
         69, 139,140,202,225,226,229,
         87, 139,140,225,226,229,
         144, 151,152,169,172,178,181,
         145, 153,154,170,171,179,180]
        )

# M ≥ 4 cases (Note: we manually corrected what I believe were an issue - in the PRL's SI,
#                    key group 4 contains 135:170, but this is most likely an error; 
#                    checking against Bilbao, I found that it should be 135:138, 169, & 170)
M4 = unique(
        [4, 11,14,17:20...,26,29,31,33,36,51:64...,76,78,90:92...,94:96...,113,114,127:130...,135:138...,169,170,173,176,178,179,182,185,186,193,194,198,205,212,213,
         67, 125,129,134,138,224,
         73, 142,206,228,230,
         85, 125,126,129,130,222,
         103, 124,130,
         104, 126,128,222,
         106, 133,135,
         110, 142,228,230,
         116, 124,130,132,138,
         117, 125,127,133,135,
         118, 126,128,134,136,222,224,
         120, 140,142,219,226,228,230,
         158, 165,184,185,188,192,193,
         159, 163,184,186,190,192,194,
         161, 167,218:220...,222,223,226,228,230,
         201, 222,224,
         208, 223,224]
        )

# There can be overlapping groups between the M≥3 and M≥4 cases;
# logically, M≥4 takes precedence over M≥3, so we remove overlaps from M3:
filter!(x->x∉(M4), M3)

# Check that we covered all the space groups:
println(sort(vcat(M2, M3, M4)) == 1:230)

pairings = sort(vcat(M2 .=> 2, M3 .=> 3, M4 .=> 4), by=x->first(x))

map(p->println(p[1], " "^(3-ndigits(p[1])), " | ", p[2]), pairings)